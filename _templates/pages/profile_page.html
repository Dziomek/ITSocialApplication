{% extends 'pages/home_base.html' %}


{% block profile %}
    {% include 'modals/followers_modal.html' %}
    {% include 'modals/following_modal.html' %}
    <link rel="stylesheet" href="/_static/css/profile_page_style.css">

    <script src="/_static/js/profile_page_script.js" defer></script>
    <div class="container-fluid d-flex flex-row justify-content-center" style="margin-top:150px">
        <div class="shadow rounded">
            <img id="profilePicture" src="{{ searched_user.profile_img.url }}" class="rounded-circle m-5" alt="avatar">
            <div>
                <div class="d-flex mx-3 justify-content-between align-items-center">
                    <h1 class="fs-0 fw-bold mt-3">{{ searched_user.firstname }} {{ searched_user.lastname }}</h1>
                    {% if current_user == searched_user %}
                    <button type="button" class="btn btn-outline-info fs-7 h-50">Edit profile
                        <i class="fa-solid fa-pen-to-square"></i>
                    </button>
                    {% endif %}
                </div>
                <div id ="followDiv" class="d-flex mx-3 justify-content-between align-items-center">
                    <h3 class="text-secondary fs-0 fw-bold mt-3">{{ searched_user.username }}</h3>

                </div>
                <hr>
                <div class="d-flex justify-content-between">
                    <div class="d-flex justify-content-evenly align-items-center w-100">
                        <a href="" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#followersModal">
                            <h6 class="text-primary fs-0 fw-bold mt-3">{{ searched_user.followers }} followers</h6>
                        </a>
                        <i class="fa-solid fa-users"></i>
                        <a href="" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#followingModal">
                            <h6 class="text-primary fs-0 fw-bold mt-3">{{ searched_user.following }} following</h6>
                        </a>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row p-2 mt-4 align-items-center">
                <i class="fa-solid fa-location-dot fs-3"></i>
                <p class="fs-5 mx-3 my-auto"><strong>Location:</strong> Krak√≥w</p>
            </div>
            <div class="d-flex flex-row p-2 align-items-center">
                <i class="fa-solid fa-cake-candles fs-3"></i>
                <p class="fs-5 mx-3 my-auto"><strong>Birthday:</strong> {{ searched_user.birthday }}</p>
            </div>
            <div class="d-flex flex-row p-2 align-items-center">
                <i class="fa-solid fa-mars-and-venus fs-3"></i>
                <p class="fs-5 mx-3 my-auto"><strong>Gender:</strong> {{ searched_user.gender }}</p>
            </div>


        </div>
        <div class="mx-3 "style="max-width: 60rem; width: 100%;">
            <div class="bg-white shadow rounded p-3 input-group-lg">
                <h1 class="text-secondary fs-0 fw-bold mt-3">Bio</h1>
            </div>
            <div class="bg-white shadow rounded p-3 input-group-lg mt-4 overflow-auto" style="max-height: 600px">
                <h1 class="text-secondary fs-0 fw-bold mt-3 mb-3">Posts</h1>
                {% for post in posts %}
                    <a href="{% url 'post_view' post.id %}" class="text-decoration-none">
                        <div class="btn btn-light w-100 text-start">
                            <h3>{{ post.topic }}</h3><p>{{ post.date }}</p>
                        </div>
                    </a>
                {% endfor%}
            </div>
        </div>
    </div>
    <script>
        let followDiv = document.getElementById('followDiv')
        let classColor = 'btn-outline-primary'
        let buttonText = 'Follow'

        {% if current_user != searched_user %}
            let aButton = document.createElement('a')
            let button = document.createElement('button')
            let i = document.createElement('i')
            i.classList.add('fa-solid', 'fa-user', 'mx-1')
            button.classList.add('btn', 'fs-7', 'h-50')
            aButton.classList.add('text-decoration-none')
            aButton.href = '{% url 'follow_or_unfollow' searched_user.username %}'
            {% for follow in follows %}
                {% if follow.follower == current_user and follow.followed_user == searched_user %}
                    classColor = 'btn-outline-danger'
                    buttonText = 'Unfollow'
                {% endif %}
            {% endfor %}
            button.classList.add(classColor)
            button.innerText = buttonText
            button.appendChild(i)

            aButton.appendChild(button)
            followDiv.appendChild(aButton)
            classColor = 'btn-outline-primary'
            buttonText = 'Follow'
        {% endif %}
    </script>

{% endblock %}